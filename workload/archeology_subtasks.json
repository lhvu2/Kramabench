{
    "archeology-hard-1": {
        "subtasks": [
            {
                "id": "archeology-hard-1-0",
                "query": "Load the radiocarbon_database_regional.xlsx and climateMeasurements.xlsx and read the first worksheet of each.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-1-1",
                "query": "Remove rows or columns that are entirely NaN from both dataframes to ensure clean numeric processing.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-1-2",
                "query": "Convert both chronologies to calendar years: for the radio-carbon table get the year as 1950 minus the \u2018date\u2019",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-1-3",
                "query": "Convert both chronologies to calendar years: for the climate table get the year as 1950 minus the rounded \u2018Age_ky.1\u2019 (in thousands of years) multiplied by 1000.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-1-4",
                "query": "Determine the span of human presence in the Maltese area by taking the minimum and maximum \u2018year\u2019 in the radio-carbon dataframe.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-1-5",
                "query": "For every integer year within the human presence span, locate the closest earlier and later rows in the climate dataframe and linearly interpolates (or directly returns) the Potassium value \u2018K\u2019 and collect all these values.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-1-6",
                "query": "Compute the mean of the collected Potassium values.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    "archeology-hard-2": {
        "subtasks": [
            {
                "id": "archeology-hard-2-0",
                "query": "Load the first sheet of radiocarbon_database_regional.xlsx and climateMeasurements.xlsx.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-2-1",
                "query": "Drop any rows or columns that are entirely NaN.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-2-2",
                "query": "Get the calendar year: for the archaeological samples, year = 1950 \u2212 date",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-2-3",
                "query": "Get the calendar year for each table: for the climate data, year = 1950 \u2212 (Age_ky.1 rounded to kyrs \u00d7 1000).",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-2-4",
                "query": "Pull the \u2018ODP 967 wet-dry index\u2019 from the nearest earlier and later climate-data bracketing rows and mark the sample as increasing (1) if the later value minus earlier value is positive, otherwise 0.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-2-5",
                "query": "Calculate the percentage of time the wet-dry index was increasing using individual sample data.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    "archeology-easy-3": {
        "subtasks": [
            {
                "id": "archeology-easy-3-0",
                "query": "Load roman_cities.csv.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-3-1",
                "query": "Filter rows where the Country column equals 'Greece'.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-3-2",
                "query": "Convert the 'Barrington Atlas Rank' column to numeric values: if the entry contains 'or', split on 'or', convert both parts to integers and take their average; otherwise convert the entry directly to an integer.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-3-3",
                "query": "Compute the mean of the converted numeric ranks of the filtered Greece rows.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    "archeology-easy-4": {
        "subtasks": [
            {
                "id": "archeology-easy-4-0",
                "query": "Load the Excel file `climateMeasurements.xlsx`, reading the first sheet while skipping the first 5 metadata rows so only data rows are retained.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-4-1",
                "query": "Remove any columns that are completely empty (all\u2010NaN) to keep only informative variables.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-4-2",
                "query": "Convert both chronologies to calendar years: for the radio-carbon table get the year as 1950 minus the \u2018date\u2019",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-4-3",
                "query": "Convert both chronologies to calendar years: for the climate table get the year as 1950 minus the rounded \u2018Age_ky.1\u2019 (in thousands of years) multiplied by 1000.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-4-4",
                "query": "Find the smallest value in the column `ODP 967 Dust proxy` and filter the dataframe to the rows that have exactly this minimum dust proxy value.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-4-5",
                "query": "If multiple rows share the same minimum dust proxy, break the tie by selecting the row with the smallest `ODP 967 wet-dry index` among them.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-4-6",
                "query": "Extract the value in the `Ca` (calcium) column, which gives the calcium concentration (ppm) at the time of minimum dust proxy.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-4-7",
                "query": "Output the calcium value for the resolved single row.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    "archeology-hard-5": {
        "subtasks": [
            {
                "id": "archeology-hard-5-0",
                "query": "Load archeology/input/climateMeasurements.xlsx, archeology/input/radiocarbon_database_regional.xlsx and read the first sheet of each into data frames.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-5-1",
                "query": "Filter the radiocarbon table to Homo-sapiens records",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-5-2",
                "query": "Compute \u2018year\u2019 as 1950 \u2212 date.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-5-3",
                "query": "Filter for Neolithic culture rows",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-5-4",
                "query": "Filter for row(s) whose Latitude equals the maximum Latitude. If several samples share that same northern latitude, keep only the one(s) with the greatest (latest) \u2018year\u2019.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-5-5",
                "query": "Clean the climate table by dropping rows that are entirely NaN and columns that are entirely NaN.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-5-6",
                "query": "Compute year for the climate table: 1950 \u2212 (Age_ky.1 rounded to 0) \u00d7 1000.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-5-7",
                "query": "Find the year in the climate table closest to the chosen Neolithic year (smallest absolute difference).",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-5-8",
                "query": "Subset the climate table to all rows that have the year closest to the chosen Neolithic year and take the maximum value of the \u2018Al\u2019 (aluminum) column across those rows.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    "archeology-easy-6": {
        "subtasks": [
            {
                "id": "archeology-easy-6-0",
                "query": "Load the worldcities.csv.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-6-1",
                "query": "Filter the rows where longitude (lng) is negative to keep cities in the Western Hemisphere.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-6-2",
                "query": "Filter those rows where latitude (lat) is negative to keep only cities that are simultaneously in the Southern Hemisphere.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-6-3",
                "query": "Find the maximum value in the population column passing the longitude and latitude filters.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-6-4",
                "query": "Select the row(s) whose population equals that maximum value (i.e., the most populous city in both hemispheres) and get the corresponding city name.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    "archeology-hard-7": {
        "subtasks": [
            {
                "id": "archeology-hard-7-0",
                "query": "Load roman_cities.csv and worldcities.csv.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-7-1",
                "query": "Extract longitude/latitude columns to build coordinates for both datasets.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-7-2",
                "query": "Filter the modern cities dataframe to keep only rows where population > 100,000.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-7-3",
                "query": "For every modern city coordinate, query the Roman cities coordinates within a 0.1-degree radius (query_ball_point with r = 0.1). Collect modern cities that have at least one Roman city within that radius.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-7-4",
                "query": "Subset the modern cities dataframe to these indices and count the resulting rows to obtain the final answer.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    "archeology-easy-8": {
        "subtasks": [
            {
                "id": "archeology-easy-8-0",
                "query": "Read the roman_cities.csv.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-8-1",
                "query": "Filter out rows where the 'Select Bibliography' field is null to keep only cities that list at least one source.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-8-2",
                "query": "Iterate over the remaining 'Select Bibliography' entries, normalize/remove period characters and split each entry on semicolons to isolate individual source strings.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-8-3",
                "query": "Take the unique set of the source strings",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-8-4",
                "query": "Find the size of the unique set.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    "archeology-hard-9": {
        "subtasks": [
            {
                "id": "archeology-hard-9-0",
                "query": "Read roman_cities.csv and worldcities.csv.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-9-1",
                "query": "Filter for modern cities whose population column is greater than 1,000,000.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-9-2",
                "query": "Convert the 'Barrington Atlas Rank' string of each Roman city into a numeric value: extract all numbers (handles 'or' cases), take their average; handle missing valuea.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-9-3",
                "query": "Build two coordinate arrays: Roman cities' (Longitude, Latitude) and modern cities' (lng, lat).",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-9-4",
                "query": "For every modern city, find all Roman cities lying within 0.1 degrees by coordinate.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-9-5",
                "query": "When matches exist, link that modern city with the Roman city that has the highest (max) numeric rank among the matches.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-9-6",
                "query": "Gather data vectors of the populations of the selected modern cities and ranks of their matched Roman cities.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-9-7",
                "query": "Compute the Pearson correlation between the two demographics data vectors.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    "archeology-easy-10": {
        "subtasks": [
            {
                "id": "archeology-easy-10-0",
                "query": "Read the worldcities.csv.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-10-1",
                "query": "Group the rows by the 'country' column and compute the mean of the 'population' column for each country.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-10-2",
                "query": "Identify the country whose mean population value is the largest (using idxmax).",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-10-3",
                "query": "Print that country name as the answer.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    "archeology-easy-11": {
        "subtasks": [
            {
                "id": "archeology-easy-11-0",
                "query": "Read worldcities.csv .",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-11-1",
                "query": "Filter rows where the 'capital' column equals 'primary' to keep only capital-city records.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-11-2",
                "query": "Identify all unique countries represented in this filtered set.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-11-3",
                "query": "For each country, if it has multiple capital records, select the capital with the largest 'population' value; otherwise keep the single record.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-11-4",
                "query": "Collect the latitude ('lat') of the chosen capital for every country.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-11-5",
                "query": "Compute the mean of these latitude values and round the result to four decimal places.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    "archeology-hard-12": {
        "subtasks": [
            {
                "id": "archeology-hard-12-0",
                "query": "Read worldcities.csv to build a set of modern country names that will be used to detect actors\u2019 home countries.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-12-1",
                "query": "Load conflict_brecke.csv",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-12-2",
                "query": "For each conflict, get the two actors by splitting the \u2018Conflict\u2019 text on \u201c-\u201d or \u201cand\u201d (otherwise treat it as a single-party conflict).",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-12-3",
                "query": "Extract start and end years for the conflicts.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-12-4",
                "query": "Search each actor string for any substring that matches a country name from the world-cities list (case-insensitive); keep the first match or drop the conflict if either actor cannot be matched to a country.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-12-5",
                "query": "Detect overlaps using data with clean records for actor-A, actor-B, start year, end year by comparing whether an end year proceeds a start year.a",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-12-6",
                "query": "Count the remaining non-overlapping conflict rows and print that count as the final answer.",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    }
}