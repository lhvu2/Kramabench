[
    {
        "id": "wildfire-easy-1",
        "query": "Find the 3-month period with the highest total acres burned since Jan 2000, according to NOAA. What was the total acres burned in that period?",
        "answer": 7805421,
        "answer_type": "numeric_exact",
        "data_sources": [
            "noaa_wildfires_monthly_stats.csv"
        ],
        "subtasks": [
            {
                "id": "wildfire-easy-1-1",
                "query": "How many acres were burned by wildfires in June 2015?",
                "answer": 1868614,
                "answer_type": "numeric_exact",
                "data_sources": [
                    "noaa_wildfires_monthly_stats.csv"
                ]
            },
            {
                "id": "wildfire-easy-1-2",
                "query": "How many acres were burned by wildfires in July 2015?",
                "answer": 3461087,
                "answer_type": "numeric_exact",
                "data_sources": [
                    "noaa_wildfires_monthly_stats.csv"
                ]
            }
        ],
        "runtime": 0.1,
        "key_functionalities": [
            {
                "id": "wildfire-easy-1-1",
                "step": "Load noaa_wildfires_monthly_stats.csv while skipping the first 3 non-data rows.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-1-2",
                "step": "Sort the dataframe by the numeric yyyyMM 'Date' column to ensure chronological order.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-1-3",
                "step": "Convert each yyyyMM value to an absolute month count (year*12 + month) to test whether two rows represent consecutive calendar months.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-1-4",
                "step": "Slide a 3-row consecutive month window through the data, using the absolute month count method.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-1-5",
                "step": "For every valid 3-month window, sum the 'Acres Burned' values; keep track of the window that produces the largest sum.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-1-6",
                "step": "After scanning all windows, report the start date, end date, and total acres burned for the window with the maximum three-month burn total (and optionally print the rows themselves).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "wildfire-easy-2",
        "query": "Which NIFC geographic area intersects with the most US states? Give the abbreviation of the geographic area",
        "answer": "EACC",
        "answer_type": "string_exact",
        "data_sources": [
            "usa.gpkg",
            "nifc_geographic_areas.gpkg"
        ],
        "subtasks": [
            {
                "id": "wildfire-easy-2-1",
                "query": "How many NIFC geographic areas are there?",
                "answer": 10,
                "answer_type": "numeric_exact",
                "data_sources": [
                    "nifc_geographic_areas.gpkg"
                ]
            },
            {
                "id": "wildfire-easy-2-2",
                "query": "How many states intersect with the Eastern Area Coordination Center?",
                "answer": 30,
                "answer_type": "numeric_exact",
                "data_sources": [
                    "usa.gpkg",
                    "nifc_geographic_areas.gpkg"
                ]
            }
        ],
        "runtime": 3,
        "key_functionalities": [
            {
                "id": "wildfire-easy-2-1",
                "step": "Load US state polygons (usa.gpkg) and NIFC geographic-area polygons (nifc_geographic_areas.gpkg) into geo data frames.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-2-2",
                "step": "Convert the NIFC geo data CRS to match the CRS of the US states geo data so spatial operations align.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-2-3",
                "step": "Dissolve the US states layer by the state-name column (adm1_name) so each state is represented by a single multipart geometry.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-2-4",
                "step": "Run a spatial predicate join (predicate = 'intersects') between the dissolved state geometries and the NIFC polygons to find which states intersect each NIFC area.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-2-5",
                "step": "Group the joined records by NIFC geographic-area name and abbreviation, and for each group count the number of unique states that intersect and collect the list of those states.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-2-6",
                "step": "Determine the maximum state-count value.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-2-7",
                "step": "Filter the nifc region data to the row(s) whose state count equals that maximum and print the corresponding NIFC geographic-area abbreviation(s) (and related info).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "wildfire-easy-3",
        "query": "Which US states (using full names) fall into the most number of NIFC Geographic Areas?",
        "answer": [
            "California",
            "Nevada"
        ],
        "answer_type": "list_exact",
        "data_sources": [
            "usa.gpkg",
            "nifc_geographic_areas.gpkg"
        ],
        "subtasks": [
            {
                "id": "wildfire-easy-3-1",
                "query": "How many NIFC geographic areas does California fall in?",
                "answer": 5,
                "answer_type": "numeric_exact",
                "data_sources": [
                    "usa.gpkg",
                    "nifc_geographic_areas.gpkg"
                ]
            }
        ],
        "runtime": 3,
        "key_functionalities": [
            {
                "id": "wildfire-easy-3-1",
                "step": "Load USA state boundaries (usa.gpkg) and NIFC Geographic Area polygons (nifc_geographic_areas.gpkg) into two geo dataframes.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-3-2",
                "step": "Re-project the NIFC geo data so both layers share the same CRS, ensuring spatial operations are valid.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-3-3",
                "step": "Dissolve the USA layer by the state name column ('adm1_name') so each state is represented by a single multipart geometry.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-3-4",
                "step": "Perform a spatial join (predicate='intersects') between the dissolved state geometries and NIFC polygons to associate each state with all NIFC regions it touches.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-3-5",
                "step": "Group the joined data by state; for each state compute (a) the count of distinct NIFC regions (nunique of 'GACCAbbreviation') and (b) the list of those unique region codes.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-3-6",
                "step": "Determine which states intersect the largest number of regions.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "wildfire-hard-4",
        "query": "Find the year with the highest suppression cost per acre of human-caused fire. What was the cost per acre, rounded to the nearest cent?",
        "answer": 2065.1,
        "answer_type": "numeric_exact",
        "data_sources": [
            "nifc_suppression_costs.csv",
            "nifc_human_caused_acres.csv"
        ],
        "subtasks": [
            {
                "id": "wildfire-hard-4-1",
                "query": "What was the total suppression cost in 2023? Give cost as a whole number",
                "answer": 3166300000,
                "answer_type": "numeric_exact",
                "data_sources": [
                    "nifc_suppression_costs.csv"
                ]
            },
            {
                "id": "wildfire-hard-4-2",
                "query": "What was the total number of acres burned by human-caused fires in 2023?",
                "answer": 1533245,
                "answer_type": "numeric_exact",
                "data_sources": [
                    "nifc_human_caused_acres.csv"
                ]
            }
        ],
        "runtime": 0.1,
        "key_functionalities": [
            {
                "id": "wildfire-hard-4-1",
                "step": "Load nifc_suppression_costs.tsv and nifc_human_caused_acres.tsv into separate dataframes.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-4-2",
                "step": "Data cleaning: remove formatting characters (commas, dollar signs) from the 'Total' columns in each file and convert the cleaned strings to numeric floats.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-4-3",
                "step": "Join the two tables on the shared Year column so each year has both its acres and suppression costs.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-4-4",
                "step": "Compute a new column cost_per_acre by dividing cleaned yearly suppression cost by acres burned.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-4-5",
                "step": "Locate the row with the maximum value in cost_per_acre to determine which year had the highest suppression cost per acre.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-4-6",
                "step": "Print that year along with the cost_per_acre rounded to two decimal places.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "wildfire-hard-5",
        "query": "On average, how many more annual fires are reported by NOAA compared to NIFC since 2000? Round to the nearest whole number.",
        "answer": -1039,
        "answer_type": "numeric_exact",
        "data_sources": [
            "noaa_wildfires_monthly_stats.csv",
            "nifc_wildfires.csv"
        ],
        "subtasks": [
            {
                "id": "wildfire-hard-5-1",
                "query": "How many total fires have been reported by NOAA since 2000?",
                "answer": 1708639,
                "answer_type": "numeric_exact",
                "data_sources": [
                    "noaa_wildfires_monthly_stats.csv"
                ]
            },
            {
                "id": "wildfire-hard-5-2",
                "query": "How many total fires have been reported by NIFC since 2000 (inclusive)?",
                "answer": 1734605,
                "answer_type": "numeric_exact",
                "data_sources": [
                    "nifc_wildfires.csv"
                ]
            }
        ],
        "runtime": 0.1,
        "key_functionalities": [
            {
                "id": "wildfire-hard-5-1",
                "step": "Load noaa_wildfires_monthly_stats.csv while skipping the first three non-data rows.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-5-2",
                "step": "Load nifc_wildfires.csv with tab delimiter.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-5-3",
                "step": "Clean the NIFC 'Fires' column by removing commas and casting the values to integers.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-5-4",
                "step": "Get 'Year' column in the NOAA dataframe from the 'Date' field.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-5-5",
                "step": "Aggregate NOAA records to annual totals by summing 'Number of Fires' within each year.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-5-6",
                "step": "Inner-join the NOAA annual totals with the cleaned NIFC data on the 'Year' column so only years present in both (2000 onward) are kept.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-5-7",
                "step": "For every matched year, compute the difference in fire counts (NOAA minus NIFC).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-5-8",
                "step": "Take the mean of these yearly differences to obtain the average discrepancy.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-5-9",
                "step": "Round this mean difference to the nearest whole number and print it.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "wildfire-hard-6",
        "query": "What is the correlation between (1) the difference between the number of NOAA and NIFC-reported fires and (2) the difference between the acres burned by NOAA and NIFC-reported fires, on an annual basis? Answer to three decimal places.",
        "answer": 0.519,
        "answer_type": "numeric_approximate",
        "data_sources": [
            "noaa_wildfires_monthly_stats.csv",
            "nifc_wildfires.csv"
        ],
        "subtasks": [
            {
                "id": "wildfire-hard-6-1",
                "query": "How many more fires were reported by NOAA compared to NIFC in 2023?",
                "answer": -1009,
                "answer_type": "numeric_exact",
                "data_sources": [
                    "noaa_wildfires_monthly_stats.csv",
                    "nifc_wildfires.csv"
                ]
            },
            {
                "id": "wildfire-hard-6-2",
                "query": "How many more acres burned were reported by NOAA compared to NIFC in 2023?",
                "answer": -60274,
                "answer_type": "numeric_exact",
                "data_sources": [
                    "noaa_wildfires_monthly_stats.csv",
                    "nifc_wildfires.csv"
                ]
            }
        ],
        "runtime": 0.1,
        "key_functionalities": [
            {
                "id": "wildfire-hard-6-1",
                "step": "Load NOAA monthly wildfire statistics CSV (skipping metadata rows) and NIFC wildfire summary TSV into dataframes.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-6-2",
                "step": "For NIFC data: strip thousands separators in 'Fires', remove asterisks and thousands separators in 'Acres', then cast both columns to integers.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-6-3",
                "step": "For NOAA data: extract the 4-digit year from the 'Date' column, convert to integer, and aggregate monthly rows to annual totals of 'Number of Fires' and 'Acres Burned'.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-6-4",
                "step": "Merge the NOAA annual dataframe with the cleaned NIFC dataframe on the common 'Year' column using an inner join so only overlapping years are kept.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-6-5",
                "step": "Compute two new columns: the year-by-year difference in number of fires (NOAA minus NIFC) and the difference in acres burned (NOAA minus NIFC).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-6-6",
                "step": "Calculate the Pearson correlation coefficient between these two difference columns and output the result rounded to three decimal places.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "wildfire-hard-7",
        "query": "Which geographic area had the most anomalous year (by Z-score) in terms of total acres burned compared to its historical annual average, and what year was it in? Answer with the geographic area and year, separated by a comma.",
        "answer": "Northwest, 2020",
        "answer_type": "string_approximate",
        "data_sources": [
            "nifc_human_caused_acres.csv",
            "nifc_lightning_caused_acres.csv"
        ],
        "subtasks": [
            {
                "id": "wildfire-hard-7-1",
                "query": "What is the historical annual average number of acres burned in the Northwest geographic area? Round to the nearest whole number",
                "answer": 953962,
                "answer_type": "numeric_exact",
                "data_sources": [
                    "nifc_human_caused_acres.csv",
                    "nifc_lightning_caused_acres.csv"
                ]
            },
            {
                "id": "wildfire-hard-7-2",
                "query": "What is the highest number of acres burned in a single year in the Northwest geographic area?",
                "answer": 5134120,
                "answer_type": "numeric_exact",
                "data_sources": [
                    "nifc_human_caused_acres.csv",
                    "nifc_lightning_caused_acres.csv"
                ]
            }
        ],
        "runtime": 0.1,
        "key_functionalities": [
            {
                "id": "wildfire-hard-7-1",
                "step": "Read nifc_human_caused_acres.csv and nifc_lightning_caused_acres.csv tab delimited.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-7-2",
                "step": "Remove asterisks from all column names to standardise them.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-7-3",
                "step": "For every geographic column convert the string values to numeric: handling 'N/A' and strip commas before casting to numbers.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-7-4",
                "step": "Sum over the human-caused and lightning-caused acre values.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-7-5",
                "step": "For every geographic area compute its historical mean and standard deviation across years, then calculate the z-score for each year: (annual value -- mean) / std.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-7-6",
                "step": "Search through the absolute z-scores for all areas and years to find the single largest (most extreme) value, and record the corresponding geographic area and year.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "wildfire-easy-8",
        "query": "Did lighting or humans cause more fires impacting above 100 acres? Answer with **only** 'Lightning' or 'Human'. No explanation needed.",
        "answer": "Lightning",
        "answer_type": "string_exact",
        "data_sources": [
            "Fire_Weather_Data_2002-2014_2016.csv"
        ],
        "runtime": 0.1,
        "subtasks": [
            {
                "id": "wildfire-easy-8-1",
                "query": "How many fires started by humans impacted more than 100 acres?",
                "answer": 1691,
                "answer_type": "numeric_approximate",
                "data_sources": [
                    "Fire_Weather_Data_2002-2014_2016.csv"
                ]
            },
            {
                "id": "wildfire-easy-8-2",
                "query": "How many fires started by lightning impacted more than 100 acres?",
                "answer": 3593,
                "answer_type": "numeric_approximate",
                "data_sources": [
                    "Fire_Weather_Data_2002-2014_2016.csv"
                ]
            }
        ],
        "key_functionalities": [
            {
                "id": "wildfire-easy-8-1",
                "step": "Read Fire_Weather_Data_2002-2014_2016.csv",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-8-2",
                "step": "Convert 'hec' to acres (acres = hec * 2.741)",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-8-3",
                "step": "Filter rows where 'acres' > 100 to focus on large fires",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-8-4",
                "step": "Group the filtered data by 'cause' and count the number of fires in each category",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-8-5",
                "step": "Compare counts for 'Lightning' versus 'Human' and output whichever count is larger, printing only the winning label",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "wildfire-easy-9",
        "query": "How many more or less fatalities occurred due to wildfires on days with humidity less than 30% compared to the average? Positive numbers indicate more, and negative numbers will indicate less. Round to four decimal places.",
        "answer": -0.0059,
        "answer_type": "numeric_approximate",
        "data_sources": [
            "Fire_Weather_Data_2002-2014_2016.csv"
        ],
        "runtime": 0.1,
        "subtasks": [
            {
                "id": "wildfire-easy-9-1",
                "query": "How many fatalities occurred on days with humidity less than 30%?",
                "answer": 0.0128,
                "answer_type": "numeric_approximate",
                "data_sources": [
                    "Fire_Weather_Data_2002-2014_2016.csv"
                ]
            },
            {
                "id": "wildfire-easy-9-2",
                "query": "What is the average number of fatalities on all days?",
                "answer": 0.0182,
                "answer_type": "numeric_approximate",
                "data_sources": [
                    "Fire_Weather_Data_2002-2014_2016.csv"
                ]
            }
        ],
        "key_functionalities": [
            {
                "id": "wildfire-easy-9-1",
                "step": "Load the Fire_Weather_Data_2002-2014_2016.csv file.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-9-2",
                "step": "Filter the rows where the humidity column ('avrh_mean') is below 30 %.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-9-3",
                "step": "Compute the mean of 'fatalities_last' for this filtered low-humidity subset.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-9-4",
                "step": "Compute the overall mean of 'fatalities_last' for the entire data set.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-9-5",
                "step": "Subtract the overall mean from the low-humidity mean to find how many more (positive) or fewer (negative) fatalities occurred on low-humidity days, and round this difference to four decimal places.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "wildfire-hard-10",
        "query": "By count, are there more fires in Democratic states or Republican states? Answer **only** with 'Democratic' or 'Republican'.",
        "answer": "Republican",
        "answer_type": "string_exact",
        "data_sources": [
            "Wildfire_Acres_by_State.csv",
            "democratic_vs_republican_votes_by_usa_state_2020.csv",
            "wildfire_total_fires_p45_54.csv"
        ],
        "runtime": 0.1,
        "subtasks": [
            {
                "id": "wildfire-hard-10-1",
                "query": "Is Alabama a Democratic or Republican state?",
                "answer": "Republican",
                "answer_type": "string_exact",
                "data_sources": [
                    "democratic_vs_republican_votes_by_usa_state_2020.csv"
                ]
            },
            {
                "id": "wildfire-hard-10-2",
                "query": "How many fires were burned in Republican states?",
                "answer": 35782,
                "answer_type": "numeric_approximate",
                "data_sources": [
                    "Wildfire_Acres_by_State.csv",
                    "democratic_vs_republican_votes_by_usa_state_2020.csv"
                ]
            },
            {
                "id": "wildfire-hard-10-3",
                "query": "How many fires were burned in Democratic states?",
                "answer": 29115,
                "answer_type": "numeric_approximate",
                "data_sources": [
                    "Wildfire_Acres_by_State.csv",
                    "democratic_vs_republican_votes_by_usa_state_2020.csv"
                ]
            }
        ],
        "key_functionalities": [
            {
                "id": "wildfire-hard-10-1",
                "step": "Read wildfire acreage data (Wildfire_Acres_by_State.csv).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-10-2",
                "step": "Read 2020 election results (democratic_vs_republican_votes_by_usa_state_2020.csv) and label each state as 'democrat' if its Democratic vote share is at least 50 %, otherwise 'republican'.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-10-3",
                "step": "Merge the party labels into the wildfire acreage dataframe on state name with an outer join so every state remains even if one of the sources is missing an entry.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-10-4",
                "step": "Read the file containing the total fire counts per state (wildfire_total_fires_p45_54.csv) and merge those counts into the combined dataframe on state name (outer join).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-10-5",
                "step": "Group the merged dataframe by the party label and aggregate (sum) the column 'Total Fires' (and also sum acreage and population, though only fires are needed for the answer).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-10-6",
                "step": "Compare the summed fire counts for the two parties to decide whether Democratic or Republican states experienced more fires.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "wildfire-hard-11",
        "query": "Which state has the most land area (in Acres) impacted by fire, per capita?",
        "answer": "Wyoming",
        "answer_type": "string_exact",
        "data_sources": [
            "Wildfire_Acres_by_State.csv"
        ],
        "runtime": 0.1,
        "subtasks": [
            {
                "id": "wildfire-hard-11-1",
                "query": "What columns should be used to calculate the land impacted by fire per capita?",
                "answer": [
                    "Total Acres Burned",
                    "Population"
                ],
                "answer_type": "list_exact",
                "data_sources": [
                    "Wildfire_Acres_by_State.csv"
                ]
            }
        ],
        "key_functionalities": [
            {
                "id": "wildfire-hard-11-1",
                "step": "Load the wildfire dataset (Wildfire_Acres_by_State.csv).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-11-2",
                "step": "Compute 'acres per capita' by dividing 'Total Acres Burned' by 'Population' for each state.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-11-3",
                "step": "Identify the row (state) with the maximum value in 'acres per capita'.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-11-4",
                "step": "Return or display that row to reveal which state has the highest fire-impacted acres per resident.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "wildfire-hard-12",
        "query": "Has fire start distribution around the year shifted earlier or later over time? Answer with **only** 'Yes' or 'No'. No explanation needed.",
        "answer": "No",
        "answer_type": "string_approximate",
        "data_sources": [
            "Fire_Weather_Data_2002-2014_2016.csv"
        ],
        "runtime": 6,
        "subtasks": [
            {
                "id": "wildfire-hard-12-1",
                "query": "What is the average start date of fires in 2004?",
                "answer": "2002-07-02",
                "answer_type": "string_approximate",
                "data_sources": [
                    "Fire_Weather_Data_2002-2014_2016.csv"
                ]
            },
            {
                "id": "wildfire-hard-12-2",
                "query": "What is the average start date of fires in 2016?",
                "answer": "2016-07-01",
                "answer_type": "string_approximate",
                "data_sources": [
                    "Fire_Weather_Data_2002-2014_2016.csv"
                ]
            }
        ],
        "key_functionalities": [
            {
                "id": "wildfire-hard-12-1",
                "step": "Read the wildfire dataset Fire_Weather_Data_2002-2014_2016.csv.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-12-2",
                "step": "Convert the 'start_date' column to datetime format, handling errors",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-12-3",
                "step": "Drop any rows where the converted 'start_date' is missing.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-12-4",
                "step": "For each target year (2002--2014, 2016) extract the month component of 'start_date'.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-12-5",
                "step": "Fit a Gaussian distribution to the month data of each year to obtain the mean (mu) and standard deviation (sigma).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-12-6",
                "step": "Collect all yearly mu (and sigma) values into a list and create a table indexed by year.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-12-7",
                "step": "Plot the yearly mu values to inspect whether the mean fire-start month shifts earlier or later over time; decide and output only 'Yes' or 'No' accordingly.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "wildfire-easy-13",
        "query": "Which of the 10 NICC-defined geographic areas requested the most helicopters for firefighting?",
        "answer": "Great Basin Area",
        "answer_type": "string_approximate",
        "data_sources": [
            "cleaned_helicopter_requests_by_region.csv"
        ],
        "runtime": 0.1,
        "subtasks": [
            {
                "id": "wildfire-easy-13-1",
                "query": "How many helicopter requests were made in the Great Basin Area?",
                "answer": 232,
                "answer_type": "numeric_approximate",
                "data_sources": [
                    "cleaned_helicopter_requests_by_region.csv"
                ]
            },
            {
                "id": "wildfire-easy-13-2",
                "query": "How many helicopter requests were made in the Southern Area?",
                "answer": 49,
                "answer_type": "numeric_approximate",
                "data_sources": [
                    "cleaned_helicopter_requests_by_region.csv"
                ]
            }
        ],
        "key_functionalities": [
            {
                "id": "wildfire-easy-13-1",
                "step": "Read the file cleaned_helicopter_requests_by_region.csv.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-13-2",
                "step": "Locate the index of the maximum value in the 'Total Helicopter Requests' column.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-13-3",
                "step": "Select and return that row, which identifies the geographic area with the greatest number of helicopter requests.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "wildfire-hard-14",
        "query": "What is the correlation between the proportion of generally unsafe air quality days according to the EPA and the amount of land affected by fires in 2024? Round to 2 decimal places.",
        "answer": 0.65,
        "answer_type": "numeric_approximate",
        "data_sources": [
            "Wildfire_Acres_by_State.csv",
            "annual_aqi_by_county_2024.csv"
        ],
        "runtime": 1,
        "subtasks": [
            {
                "id": "wildfire-hard-14-1",
                "query": "What day types are considered generally unsafe air quality days?",
                "answer": [
                    "Unhealthy Days",
                    "Very Unhealthy Days",
                    "Hazardous Days"
                ],
                "answer_type": "list_exact",
                "data_sources": [
                    "annual_aqi_by_county_2023.csv"
                ]
            },
            {
                "id": "wildfire-hard-14-2",
                "query": "What is the proportion of generally safe air quality days according to the EPA in 2024 in Alabama? Round to 4 decimal places.",
                "answer": 0.7809,
                "answer_type": "numeric_approximate",
                "data_sources": [
                    "annual_aqi_by_county_2023.csv"
                ]
            },
            {
                "id": "wildfire-hard-14-3",
                "query": "What is the correlation between the proportion of generally unsafe air quality days according to the EPA and the amount of land affected by fires in 2022? Round to 4 decimal places.",
                "answer": -0.0404,
                "answer_type": "numeric_approximate",
                "data_sources": [
                    "Wildfire_Acres_by_State.csv",
                    "annual_aqi_by_county_2022.csv"
                ]
            }
        ],
        "key_functionalities": [
            {
                "id": "wildfire-hard-14-1",
                "step": "Read annual air-quality (annual_aqi_by_county_2024.csv) and wildfire acreage (Wildfire_Acres_by_State.csv) datasets.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-14-2",
                "step": "Aggregate the AQI data to state level by taking the mean of the good day proportion calculated as Good Days / Days with AQI in the AQI data.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-14-3",
                "step": "Join the state-level AQI dataframe with the wildfire dataframe on the State column.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-14-4",
                "step": "Convert the 'Total Acres Burned' column to numeric to ensure proper calculations.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-14-5",
                "step": "Compute the Pearson correlation between good day proportion and 'Total Acres Burned'.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "wildfire-easy-15",
        "query": "According to NOAA, in Julies, are the size of a fire and the median wind speed in the area strongly correlated? The answer should be Yes or No.",
        "answer": "No",
        "answer_type": "string_exact",
        "data_sources": [
            "noaa_wildfires.csv",
            "noaa_wildfires_variabledescrip.csv"
        ],
        "subtasks": [
            {
                "id": "wildfire-easy-15-1",
                "query": "Calculate the correlation coefficient between the size of a fire and the median wind speed in the area in Julies based on NOAA data.",
                "answer": -0.01,
                "answer_type": "numeric_approximate",
                "data_sources": [
                    "noaa_wildfires.csv",
                    "noaa_wildfires_variabledescrip.csv"
                ]
            }
        ],
        "runtime": 0.1,
        "key_functionalities": [
            {
                "id": "wildfire-easy-15-1",
                "step": "Read the NOAA wild-fires dataset from noaa_wildfires.csv.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-15-2",
                "step": "Filter the dataframe to include only fires that started in July by keeping rows whose start_day_of_year is between 181 (inclusive) and 213 (exclusive).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-15-3",
                "step": "Compute the Pearson correlation coefficient between the fire size (column 'hec') and the median wind speed (column 'wind_med') for the July subset.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-easy-15-4",
                "step": "Determine whether the resulting correlation coefficient indicates a strong relationship (the code comments conclude it is not strong, hence the answer would be 'No').",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "wildfire-hard-16",
        "query": "According to NOAA, find the breakdowns of causes of fires of each geographical region for fires with known causes that start in the months of January, February, and March? Perform a chi-square statistics test. What are the chi-square statistic and p-value? Report a list of two numbers.",
        "answer": [
            6.326,
            0.787
        ],
        "answer_type": "list_exact",
        "data_sources": [
            "noaa_wildfires.csv",
            "noaa_wildfires_variabledescrip.csv"
        ],
        "subtasks": [
            {
                "id": "wildfire-hard-16-1",
                "query": "What are the geographical regions in wildfire studies based on NOAA definitions?",
                "answer": [
                    "California",
                    "Great Basin",
                    "Northwest",
                    "Inland Empire",
                    "Rocky Mountains",
                    "Southwest"
                ],
                "answer_type": "list_exact",
                "data_sources": [
                    "noaa_wildfires_variabledescrip.csv"
                ]
            },
            {
                "id": "wildfire-hard-16-2",
                "query": "What days of the year are January, February, and March? Answer with a list [start_day, end_day]",
                "answer": [
                    1,
                    92
                ],
                "answer_type": "list_exact",
                "data_sources": [
                    "noaa_wildfires.csv"
                ]
            },
            {
                "id": "wildfire-hard-16-3",
                "query": "What are the causes of wildfire as defined by NOAA?",
                "answer": [
                    "natural",
                    "human",
                    "lightning",
                    "other"
                ],
                "answer_type": "list_exact",
                "data_sources": [
                    "noaa_wildfires_variabledescrip.csv"
                ]
            },
            {
                "id": "wildfire-hard-16-4",
                "query": "According to NOAA, in the months of January, February, and March, what are the breakdowns of wildfire causes in the California region? Give me a list of percentages.",
                "answer": [
                    "0.0%",
                    "8.33%",
                    "91.67%",
                    "0.0%"
                ],
                "answer_type": "list_exact",
                "data_sources": [
                    "noaa_wildfires.csv",
                    "noaa_wildfires_variabledescrip.csv"
                ]
            },
            {
                "id": "wildfire-hard-16-5",
                "query": "According to NOAA, in the months of January, February, and March, what are the breakdowns of wildfire causes in the Great Basin region? Give me a list of percentages.",
                "answer": [
                    "0.0%",
                    "0.0%",
                    "100.0%",
                    "0.0%"
                ],
                "answer_type": "list_exact",
                "data_sources": [
                    "noaa_wildfires.csv",
                    "noaa_wildfires_variabledescrip.csv"
                ]
            },
            {
                "id": "wildfire-hard-16-6",
                "query": "According to NOAA, in the months of January, February, and March, what are the breakdowns of wildfire causes in the Inland Empire region? Give me a list of percentages.",
                "answer": [
                    "14.29%",
                    "0.0%",
                    "85.71%",
                    "0.0%"
                ],
                "answer_type": "list_exact",
                "data_sources": [
                    "noaa_wildfires.csv",
                    "noaa_wildfires_variabledescrip.csv"
                ]
            },
            {
                "id": "wildfire-hard-16-7",
                "query": "According to NOAA, in the months of January, February, and March, what is the most common wildfire cause across all regions.",
                "answer": [
                    "human"
                ],
                "answer_type": "string_exact",
                "data_sources": [
                    "noaa_wildfires.csv",
                    "noaa_wildfires_variabledescrip.csv"
                ]
            },
            {
                "id": "wildfire-hard-16-8",
                "query": "According to NOAA, in the months of January, February, and March, which regions have the most wildfires caused by lighting?",
                "answer": [
                    "California"
                ],
                "answer_type": "string_exact",
                "data_sources": [
                    "noaa_wildfires.csv",
                    "noaa_wildfires_variabledescrip.csv"
                ]
            }
        ],
        "runtime": 0.1,
        "key_functionalities": [
            {
                "id": "wildfire-hard-16-1",
                "step": "Load the wildfire dataset from noaa_wildfires.csv.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-16-2",
                "step": "Convert the start_date column to datetime format so month filtering can be performed.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-16-3",
                "step": "Keep only the fires whose start_date month is January, February, or March.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-16-4",
                "step": "Exclude rows whose cause is coded as 'U' (unknown) so only known-cause fires remain.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-16-5",
                "step": "Build a contingency table (cross-tabulation) counting the number of fires for every combination of region and cause.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-16-6",
                "step": "From the contingency table, obtain the chi-square statistic and the associated p-value.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "wildfire-hard-17",
        "query": "What is the average elevation (in feet) of the weather stations used for fire site monitoring in the NOAA dataset? Round to one digit after decimal.",
        "answer": 4830.9,
        "answer_type": "numeric_exact",
        "data_sources": [
            "noaa_wildfires.csv",
            "noaa_wildfires_variabledescrip.csv",
            "PublicView_RAWS_-3515561676727363726.csv"
        ],
        "subtasks": [
            {
                "id": "wildfire-hard-17-1",
                "query": "How many unique RAWS weather stations are used by NOAA as firewatch weather stations?",
                "answer": 759,
                "answer_type": "numeric_exact",
                "data_sources": [
                    "noaa_wildfires.csv",
                    "noaa_wildfires_variabledescrip.csv",
                    "PublicView_RAWS_-3515561676727363726.csv"
                ]
            },
            {
                "id": "wildfire-hard-17-2",
                "query": "What transformations do we need to do for the weather stations data in order to join with the wildfire data?",
                "answer": "Convert NWS ID column to numeric to match with station_verified_in_psa in the wildfire data.",
                "answer_type": "string_approximate",
                "data_sources": [
                    "noaa_wildfires.csv",
                    "noaa_wildfires_variabledescrip.csv",
                    "PublicView_RAWS_-3515561676727363726.csv"
                ]
            }
        ],
        "runtime": 0.1,
        "key_functionalities": [
            {
                "id": "wildfire-hard-17-1",
                "step": "Read wildfire incident data and RAW station metadata CSV files into DataFrames.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-17-2",
                "step": "Extract the unique station IDs used for fire monitoring from the fires data (`station_verified_in_psa`).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-17-3",
                "step": "Ensure the station-ID field in the station metadata (`NWS ID`) is numeric so it can be compared with the ID list, coercing non-numeric values to NaN.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-17-4",
                "step": "Subset the station metadata to only the rows whose `NWS ID` appears in the list of used stations.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-17-5",
                "step": "From this filtered subset, drop missing values in the `Elevation` column and compute the mean elevation.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-17-6",
                "step": "Print the count of unique stations, the count with elevation data, and the resulting average elevation.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "wildfire-hard-18",
        "query": "Based on the NOAA dataset, controlling for the weather, do more aggressive suppression actually contribute to fire ending faster and affecting less buildings?",
        "answer": "More aggressive suppression does not help fires end faster but helps fires affect less buildings.",
        "answer_type": "string_approximate",
        "data_sources": [
            "noaa_wildfires.csv",
            "noaa_wildfires_variabledescrip.csv"
        ],
        "subtasks": [
            {
                "id": "wildfire-hard-18-1",
                "query": "Which columns encode the suppression strategies for wildfire",
                "answer": [
                    "dominant_strategy_25_s",
                    "dominant_strategy_50_s",
                    "dominant_strategy_75_s",
                    "subdom_strategy"
                ],
                "answer_type": "list_exact",
                "data_sources": [
                    "noaa_wildfires.csv",
                    "noaa_wildfires_variabledescrip.csv"
                ]
            },
            {
                "id": "wildfire-hard-18-2",
                "query": "Which columns should we control for?",
                "answer": [
                    "avrh_mean",
                    "wind_med",
                    "erc_med",
                    "rain_sum",
                    "hec"
                ],
                "answer_type": "list_exact",
                "data_sources": [
                    "noaa_wildfires.csv",
                    "noaa_wildfires_variabledescrip.csv"
                ]
            },
            {
                "id": "wildfire-hard-18-3",
                "query": "Controlling for the weather-related columns and fire size in hectares, what is the coefficient of dominant_strategy_25_s on fire duration?",
                "answer": -20.88,
                "answer_type": "numeric_approximate",
                "data_sources": [
                    "noaa_wildfires.csv",
                    "noaa_wildfires_variabledescrip.csv"
                ]
            },
            {
                "id": "wildfire-hard-18-4",
                "query": "Controlling for the weather-related columns and fire size in hectares, what is the coefficient of dominant_strategy_25_s on the number of residential houses damanged?",
                "answer": 542.65,
                "answer_type": "numeric_approximate",
                "data_sources": [
                    "noaa_wildfires.csv",
                    "noaa_wildfires_variabledescrip.csv"
                ]
            }
        ],
        "runtime": 24,
        "key_functionalities": [
            {
                "id": "wildfire-hard-18-1",
                "step": "Load noaa_wildfires.csv.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-18-2",
                "step": "Create three binary indicator columns that equal 1 when the dominant strategy (at 25 %, 50 %, or 75 % containment) is 'Full Suppression' and 0 otherwise.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-18-3",
                "step": "Drop any rows that contain missing values so the regression sample has complete data.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-18-4",
                "step": "For each indicator level (25 %, 50 %, 75 %):\n  \n- Build a regression design matrix that contains the suppression-strategy indicator plus weather-control variables (avrh_mean, wind_med, erc_med, rain_sum) and fire-size control hec, then add a constant term.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-18-5",
                "step": "Run an OLS regression with robust (HC3) standard errors using\n  \n- dependent variable = fire duration,\n  \n- independent variables = suppression indicator + weather / size controls, and record the summary.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-18-6",
                "step": "Repeat the same three regressions but with dependent variable = number of threatened buildings (prim_threatened_aggregate), again using robust standard errors, and record those summaries as well. Use the regression outcome to answer the question.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "wildfire-hard-19",
        "query": "In 2016, what percentage (to 2 decimal places) of fires were brought under control with it raining moderately or heavily (>0.05 in) in the fire area on the same or a day before the control day? Assume that the narrowest diameter of the fire area is 1km. Under this assumption, if a weather station falls into the fire area, you can use the detailed weather observation from that station for that fire incident.",
        "answer": 19.55,
        "answer_type": "numeric_approximate",
        "data_sources": [
            "noaa_wildfires.csv",
            "noaa_wildfires_variabledescrip.csv",
            "WeatherEvents_Jan2016-Dec2022.csv"
        ],
        "runtime": 5257,
        "key_functionalities": [
            {
                "id": "wildfire-hard-19-1",
                "step": "Read WeatherEvents_Jan2016-Dec2022.csv",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-19-2",
                "step": "Filter for rows whose StartTime(UTC) begins with 2016 (i.e., events that occurred in 2016).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-19-3",
                "step": "Convert each weather event's StartTime(UTC) and EndTime(UTC) to local time using the station-specific time-zone and store them in new columns.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-19-4",
                "step": "For each local start / end timestamp derive the 'day-of-year' integer so we can check if the event overlaps a specific calendar day.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-19-5",
                "step": "Read noaa_wildfires.csv and keep only fire incidents whose control_year is 2016.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-19-6",
                "step": "For every 2016 fire determine the day before the control day (control_day_of_year - 1) and a boolean column 'rained' initialised to False.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-19-7",
                "step": "Perform a UDF join: Loop through every fire incident and pull the subset of 2016 weather rows whose local start-end window covers either the control day itself or the previous day.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-19-8",
                "step": "Perform a UDF join: Keep only rows where Type == 'Rain', precipitation is greater than 0.05 inches, and the station lies inside the fire area: compute the geodesic distance between the station and the fire coordinates and require distance <= sqrt(hectares/100) km (~= radius of the fire's 1-km narrowest diameter assumption).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-19-9",
                "step": "If at least one such rain record is found for the fire, mark the fire's 'rained' flag True.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-19-10",
                "step": "After examining all 2016 fires, compute the percentage: mean of the 'rained' boolean column * 100 and print with two-decimal formatting.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "wildfire-hard-20",
        "query": "According to NOAA, what percentage (to 2 decimal places) of wildfires account for at least 90% of residential houses damaged in 2008?",
        "answer": 13.93,
        "answer_type": "numeric_exact",
        "data_sources": [
            "noaa_wildfires.csv",
            "noaa_wildfires_variabledescrip.csv"
        ],
        "subtasks": [
            {
                "id": "wildfire-hard-20-1",
                "query": "According to NOAA, how many residential houses were damaged due to wildfires in 2008?",
                "answer": 370202,
                "answer_type": "numeric_approximate",
                "data_sources": [
                    "noaa_wildfires.csv",
                    "noaa_wildfires_variabledescrip.csv"
                ]
            }
        ],
        "runtime": 0.5,
        "key_functionalities": [
            {
                "id": "wildfire-hard-20-1",
                "step": "Load noaa_wildfires.csv into a DataFrame.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-20-2",
                "step": "Filter the rows to keep only those where control_year equals 2008.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-20-3",
                "step": "Sort the 2008 fires in descending order by the column prim_threatened_aggregate (number of houses threatened/damaged).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-20-4",
                "step": "Compute the total number of houses damaged for 2008 and calculate the 90 % threshold (total * 0.9, cast to int).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-20-5",
                "step": "For the sorted fires, cumulatively sum prim_threatened_aggregate until the running sum meets or exceeds the threshold.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-20-6",
                "step": "Capture the DataFrame index at which this cumulative sum first reaches 90 % of the damage total.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-20-7",
                "step": "Calculate the percentage of fires needed to reach the 90 % damage threshold by dividing that index value by the total count of 2008 fires and print the result.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "wildfire-hard-21",
        "query": "Based on NOAA data, what are the top 3 states that lost the most residential property in value between 2005 and 2010 (including 2005 and 2010)? Answer in state full names.",
        "answer": [
            "California",
            "Washington",
            "Montana"
        ],
        "answer_type": "list_exact",
        "data_sources": [
            "noaa_wildfires.csv",
            "noaa_wildfires_variabledescrip.csv",
            "ZHVI.csv"
        ],
        "subtasks": [
            {
                "id": "wildfire-hard-21-1",
                "query": "On what columns to join the wildfire data and the housing index price data?",
                "answer": "start_year, start_day_of_year in wildfire data and unnamed volumn in housing index price data.",
                "answer_type": "string_approximate",
                "data_sources": [
                    "noaa_wildfires.csv",
                    "ZHVI.csv"
                ]
            }
        ],
        "runtime": 0.5,
        "key_functionalities": [
            {
                "id": "wildfire-hard-21-1",
                "step": "Load mapping of state abbreviations to full state names from state_abbreviation_to_state.json.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-21-2",
                "step": "Read NOAA wildfire event data (noaa_wildfires.csv) and drop any rows with missing values.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-21-3",
                "step": "Read monthly Zillow Home Value Index data for each state (ZHVI.csv).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-21-4",
                "step": "Filter the wildfire data to only include events whose start_year is between 2005 and 2010 inclusive.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-21-5",
                "step": "Convert start_day_of_year to a calendar month in wildfire record",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-21-6",
                "step": "Create a date string 'YYYY-MM-01' from calendar year month for wildfire data and use this and the state information to join with ZHVI price data",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-21-7",
                "step": "Multiply the price joined using state and month by prim_threatened_aggregate to compute the dollar value of residential property threatened/lost for that fire.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-21-8",
                "step": "Sum by state and over time to obtain total property value lost per state during 2005-2010.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-21-9",
                "step": "Take the three largest values of the state-wide totals.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "wildfire-hard-21-10",
                "step": "Output corresponding state names.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    }
]