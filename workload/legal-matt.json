[
    {
        "id": "legal-easy-matt-1",
        "query": "Which branch of the U.S. Military had the largest \"Median Fraud Loss\" reported by its service members in 2024?",
        "answer": "U.S. Space Force",
        "answer_type": "string",
        "data_sources": [
            "2024_CSN_Fraud, Identity Theft, and Other Reports by Military Consumers.csv"
        ],
        "subtasks": [
            {
                "id": "legal-easy-matt-1-subtask-1",
                "query": "Extract the table which breaks down the number of reports by military branch",
                "answer": [
                    {
                        "Military Branch": "U.S. Air Force",
                        "# of Reports": "39,063",
                        "# of Fraud Reports": "19,825",
                        "% Reporting Fraud Loss": "27%",
                        "Total Fraud Loss": "$96M",
                        "Median Fraud Loss": "$584 "
                    },
                    {
                        "Military Branch": "U.S. Army",
                        "# of Reports": "91,035",
                        "# of Fraud Reports": "38,885",
                        "% Reporting Fraud Loss": "32%",
                        "Total Fraud Loss": "$217M",
                        "Median Fraud Loss": "$731 "
                    },
                    {
                        "Military Branch": "U.S. Coast Guard",
                        "# of Reports": "3,292",
                        "# of Fraud Reports": "1,643",
                        "% Reporting Fraud Loss": "33%",
                        "Total Fraud Loss": "$9M",
                        "Median Fraud Loss": "$500 "
                    },
                    {
                        "Military Branch": "U.S. Marines",
                        "# of Reports": "20,838",
                        "# of Fraud Reports": "9,195",
                        "% Reporting Fraud Loss": "33%",
                        "Total Fraud Loss": "$54M",
                        "Median Fraud Loss": "$727 "
                    },
                    {
                        "Military Branch": "U.S. Navy",
                        "# of Reports": "40,907",
                        "# of Fraud Reports": "19,101",
                        "% Reporting Fraud Loss": "30%",
                        "Total Fraud Loss": "$95M",
                        "Median Fraud Loss": "$569 "
                    },
                    {
                        "Military Branch": "U.S. Space Force",
                        "# of Reports": "784",
                        "# of Fraud Reports": "509",
                        "% Reporting Fraud Loss": "45%",
                        "Total Fraud Loss": "$12M",
                        "Median Fraud Loss": "$1,300 "
                    }
                ],
                "answer_type": "DataFrame",
                "data_sources": [
                    "2024_CSN_Fraud, Identity Theft, and Other Reports by Military Consumers.csv"
                ]
            },
            {
                "id": "legal-easy-matt-1-subtask-2",
                "query": "Compute the U.S. Military branch with the largest \"Median Fraud Loss\"",
                "answer": "U.S. Space Force",
                "answer_type": "string",
                "data_sources": [
                    "2024_CSN_Fraud, Identity Theft, and Other Reports by Military Consumers.csv"
                ]
            }
        ]
    },
    {
        "id": "legal-easy-matt-2",
        "query": "Which states had \"Identity Theft\" as their top report category?",
        "answer": [
            "Arizona",
            "California",
            "Massachusetts",
            "Ohio",
            "Oklahoma",
            "Rhode Island"
        ],
        "answer_type": "list[string]",
        "data_sources": [
            "2024_CSN_State_Top_Ten_Report_Categories.csv"
        ],
        "subtasks": [
            {
                "id": "legal-easy-matt-2-subtask-1",
                "query": "Extract the table with the top-ten report categories for each state",
                "answer": [
                    "df = pd.read_csv(\"2024_CSN_State_Top_Ten_Report_Categories.csv\")",
                    "df = df.iloc[1:-4]",
                    "column_names = list(df.iloc[0].to_dict().values())",
                    "df.columns = [col.strip() for col in column_names]",
                    "df = df.iloc[1:]"
                ],
                "answer_type": "code",
                "data_sources": [
                    "2024_CSN_State_Top_Ten_Report_Categories.csv"
                ]
            },
            {
                "id": "legal-easy-matt-2-subtask-2",
                "query": "group-by state and return each state whose top report category is \"Identity Theft\"",
                "answer": [
                    "Arizona",
                    "California",
                    "Massachusetts",
                    "Ohio",
                    "Oklahoma",
                    "Rhode Island"
                ],
                "answer_type": "list[string]",
                "data_sources": [
                    "2024_CSN_State_Top_Ten_Report_Categories.csv"
                ]
            }
        ]
    },
    {
        "id": "legal-easy-matt-3",
        "query": "How many states had \"Prizes, Sweepstakes and Lotteries\" in their top-10 report categories?",
        "answer": 27,
        "answer_type": "integer",
        "data_sources": [
            "2024_CSN_State_Top_Ten_Report_Categories.csv"
        ],
        "subtasks": [
            {
                "id": "legal-easy-matt-3-subtask-1",
                "query": "Extract the table with the top-ten report categories for each state",
                "answer": [
                    "df = pd.read_csv(\"2024_CSN_State_Top_Ten_Report_Categories.csv\")",
                    "df = df.iloc[1:-4]",
                    "column_names = list(df.iloc[0].to_dict().values())",
                    "df.columns = [col.strip() for col in column_names]",
                    "df = df.iloc[1:]"
                ],
                "answer_type": "code",
                "data_sources": [
                    "2024_CSN_State_Top_Ten_Report_Categories.csv"
                ]
            },
            {
                "id": "legal-easy-matt-3-subtask-2",
                "query": "group-by state and count each state which has \"Prizes, Sweepstakes and Lotteries\" in its top-ten categories",
                "answer": 27,
                "answer_type": "integer",
                "data_sources": [
                    "2024_CSN_State_Top_Ten_Report_Categories.csv"
                ]
            }
        ]
    },
    {
        "id": "legal-hard-matt-1",
        "query": "In 2024, as a percentage of all reports, did military consumers report a higher percentage of Imposter Scams than the general population?",
        "answer": true,
        "answer_type": "boolean",
        "data_sources": [
            "2024_CSN_Reports_by_Military_Consumers.csv",
            "2024_CSN_Report_Categories.csv"
        ],
        "subtasks": [
            {
                "id": "legal-hard-matt-1-subtask-1",
                "query": "Compute the total number of reports by military consumers",
                "answer": 213831,
                "answer_type": "integer",
                "data_sources": [
                    "2024_CSN_Reports_by_Military_Consumers.csv"
                ]
            },
            {
                "id": "legal-hard-matt-1-subtask-2",
                "query": "Compute the number of Imposter Scams reported by military consumers",
                "answer": 44587,
                "answer_type": "integer",
                "data_sources": [
                    "2024_CSN_Reports_by_Military_Consumers.csv"
                ]
            },
            {
                "id": "legal-hard-matt-1-subtask-3",
                "query": "Compute the percentage of reports by military consumers which are Imposter Scams",
                "answer": 0.2085,
                "answer_type": "float",
                "data_sources": [
                    "2024_CSN_Reports_by_Military_Consumers.csv"
                ]
            },
            {
                "id": "legal-hard-matt-1-subtask-4",
                "query": "Compute the percentage of reports by the general population which are Imposter Scams",
                "answer": 0.1307,
                "answer_type": "float",
                "data_sources": [
                    "2024_CSN_Report_Categories.csv"
                ]
            },
            {
                "id": "legal-hard-matt-1-subtask-5",
                "query": "Determine whether military consumers report a higher percentage of Imposter Scams than the general population",
                "answer": true,
                "answer_type": "boolean",
                "data_sources": [
                    "2024_CSN_Reports_by_Military_Consumers.csv",
                    "2024_CSN_Report_Categories.csv"
                ]
            }
        ]
    },
    {
        "id": "legal-hard-matt-2",
        "query": "Among states with 5 or more metro areas, which metropolitan area had the largest percentage of fraud reports in its own state?",
        "answer": "Washington-Arlington-Alexandria, DC-VA-MD-WV Metropolitan Statistical Area",
        "answer_type": "string",
        "data_sources": [
            "State MSA Fraud and Other Data/*.csv"
        ],
        "subtasks": [
            {
                "id": "legal-hard-matt-2-subtask-1",
                "query": "Identify the states with five or more metro areas",
                "answer": [
                    "Alabama",
                    "Arizona",
                    "Arkansas",
                    "California",
                    "Colorado",
                    "Connecticut",
                    "Florida",
                    "Georgia",
                    "Idaho",
                    "Illinois",
                    "Indiana",
                    "Iowa",
                    "Kansas",
                    "Kentucky",
                    "Louisiana",
                    "Maryland",
                    "Massachusetts",
                    "Michigan",
                    "Minnesota",
                    "Mississippi",
                    "Missouri",
                    "New Jersey",
                    "New York",
                    "North Carolina",
                    "Ohio",
                    "Oregon",
                    "Pennsylvania",
                    "South Carolina",
                    "Tennessee",
                    "Texas",
                    "Utah",
                    "Virginia",
                    "Washington",
                    "West Virginia",
                    "Wisconsin"
                ],
                "answer_type": "list[string]",
                "data_sources": [
                    "State MSA Fraud and Other Data/*.csv"
                ]
            },
            {
                "id": "legal-hard-matt-2-subtask-2",
                "query": "For each metro area, compute its percentage of its state's total fraud reports",
                "answer": [
                    "state_df['fraud_report_pct'] = state_df['# of Reports'] / state_df['# of Reports'].sum()"
                ],
                "answer_type": "code",
                "data_sources": [
                    "State MSA Fraud and Other Data/*.csv"
                ]
            },
            {
                "id": "legal-hard-matt-2-subtask-3",
                "query": "Identify the metro area with the largest percentage of its state's total fraud reports",
                "answer": "Washington-Arlington-Alexandria, DC-VA-MD-WV Metropolitan Statistical Area",
                "answer_type": "string",
                "data_sources": [
                    "State MSA Fraud and Other Data/*.csv"
                ]
            }
        ]
    },
    {
        "id": "legal-hard-matt-3",
        "query": "Does there exist a metropolitan area in which the number of reports of identity theft exceeded the number of reports of fraud in 2024?",
        "answer": false,
        "answer_type": "boolean",
        "data_sources": [
            "State MSA Fraud and Other Data/*.csv",
            "State MSA Identity Theft Data/*.csv"
        ],
        "subtasks": [
            {
                "id": "legal-hard-matt-3-subtask-1",
                "query": "For each metro area, compute its number of fraud reports",
                "answer": [
                    "# for a single state CSV",
                    "df = pd.read_csv(state_fraud_csv_filepath)",
                    "df = df.iloc[1:-4]",
                    "column_names = list(df.iloc[0].to_dict().values())",
                    "df.columns = [col.strip() for col in column_names]",
                    "df = df.iloc[1:]",
                    "df['# of Reports'] = df['# of Reports'].apply(lambda entry: int(entry.replace(',','')))",
                    "metro_area_to_fraud_reports = **pd.Series(df['# of Reports'], index=df['Metropolitan Area'].values).to_dict()"
                ],
                "answer_type": "code",
                "data_sources": [
                    "State MSA Fraud and Other Data/*.csv"
                ]
            },
            {
                "id": "legal-hard-matt-3-subtask-2",
                "query": "For each metro area, compute its number of identity theft reports",
                "answer": [
                    "# for a single state CSV",
                    "df = pd.read_csv(state_identity_theft_csv_filepath)",
                    "df = df.iloc[1:-4]",
                    "column_names = list(df.iloc[0].to_dict().values())",
                    "df.columns = [col.strip() for col in column_names]",
                    "df = df.iloc[1:]",
                    "df['# of Reports'] = df['# of Reports'].apply(lambda entry: int(entry.replace(',','')))",
                    "metro_area_to_identity_theft_reports = **pd.Series(df['# of Reports'], index=df['Metropolitan Area'].values).to_dict()"
                ],
                "answer_type": "code",
                "data_sources": [
                    "State MSA Identity Theft Data/*.csv"
                ]
            },
            {
                "id": "legal-hard-matt-3-subtask-3",
                "query": "Identify whether any metro area had more reports of identity theft than reports of fraud",
                "answer": false,
                "answer_type": "boolean",
                "data_sources": [
                    "State MSA Fraud and Other Data/*.csv",
                    "State MSA Identity Theft Data/*.csv"
                ]
            }
        ]
    }
]